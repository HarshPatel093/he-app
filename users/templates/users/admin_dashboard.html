
{% extends "base.html" %}
{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<div style="
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-template-rows: repeat(2, 1fr);
  gap: 25px;
  width: 100%;
  height: calc(100vh - 120px);
  padding: 20px;
  box-sizing: border-box;
  justify-items: center;
  align-items: center;
">

  <div style="width: 350px; height: 350px;">
    <canvas id="monthlyGoalsPie"></canvas>
  </div>
  
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
const ctx = document.getElementById('monthlyGoalsPie');

new Chart(ctx, {
    type: 'pie',
    data: {
        labels: {{ labels|safe }},
        datasets: [{
            label: 'Goals Added',
            data: {{ data|safe }},
            backgroundColor: ['#60a5fa', '#34d399', '#fbbf24', '#f87171'],
            hoverOffset: 10
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            title: {
                display: true,
                text: 'Goals Added in {{ month_name }}',
                font: { size: 16 }
            },
            legend: {
                position: 'bottom',
                labels: { boxWidth: 12, font: { size: 12 } }
            },
            tooltip: {
                callbacks: {
                    label: function(context) {
                        const label = context.label || '';
                        const value = context.raw;
                        const total = context.chart._metasets[0].total;
                        const percentage = ((value / total) * 100).toFixed(1);
                        return `${label}: ${value} goals (${percentage}%)`;
                    }
                }
            }
        }
    }
});
</script>

{% endblock %}